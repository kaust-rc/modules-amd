#%Module 1.0 -*- tcl -*-

source [file dirname $::ModulesCurrentModulefile]/../../../common/setup.tcl 
GeneralAppSetup

# Load compiler based on module build
# Find last dash in the string
#set ::last_dash_index [expr [string last - $module_build] - 1]
# Get substring containing first two dashes
#set ::substring [string range $module_build 0 $last_dash_index]
#set ::middle_dash_index [expr [string last - $substring] - 1]
# Extract MPI library/compiler from module build
#set ::mpi [string range $module_build 0 $middle_dash_index]
# Extract compiler from module build. We have to readd offsets we took off before
#set ::compiler [string range $module_build [expr $middle_dash_index + 2] end]
#set ::module_to_load [string map {- /} $mpi]/$compiler
#if ![is-loaded compilers-extra] {
#    module load compilers-extra
#}
#if ![is-loaded $module_to_load] {
if ![is-loaded gcc/4.9.1] {
    module load gcc/4.9.1
}
#if ![is-loaded compilers-extra] {
#    module load compilers-extra
#}
prepend-path    PATH $app_dir/build
prepend-path    PATH $app_dir/bin
setenv          MOLCAS $app_dir
setenv          MOLCAS_CPUS 8


## OPENMPI
prepend-path	PATH	$app_dir/thirdparty/openmpi/bin
prepend-path	MANPATH	$app_dir/thirdparty/openmpi/share/man
prepend-path	LD_LIBRARY_PATH	$app_dir/thirdparty/openmpi/lib
prepend-path	LIBRARY_PATH	$app_dir/thirdparty/openmpi/lib
prepend-path	CPATH	$app_dir/thirdparty/openmpi/include

# Prereqs

# # Specific setup goes here, license files, path setup, etc
# prepend-path PATH               $app_dir/bin
# prepend-path LD_LIBRARY_PATH    $app_dir/lib
# prepend-path MANPATH            $app_dir/share/man
